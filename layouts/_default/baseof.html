<!DOCTYPE html>
<html lang="{{ .Language.Lang }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{{ if .Params.description }}{{ .Params.description | plainify | truncate 160 }}{{ else if .Description }}{{ .Description | plainify | truncate 160 }}{{ else }}{{ .Site.Params.description }}{{ end }}">
    {{ if .Site.Params.yandex_verification }}
    <meta name="yandex-verification" content="{{ .Site.Params.yandex_verification }}" />
    {{ end }}
    {{ if .Site.Params.google_verification }}
    <meta name="google-site-verification" content="{{ .Site.Params.google_verification }}" />
    {{ end }}
    <title>{{ if and .Title (not .IsHome) }}{{ .Title }} — {{ end }}{{ if or (eq .Site.Language.Lang "en") (hasPrefix .RelPermalink "/en/") }}Kirill Shvakov{{ else }}{{ .Site.Title }}{{ end }}</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="stylesheet" href="/assets/site.css">
    <link rel="canonical" href="{{ .Permalink }}">
    {{ range .Site.Languages }}
    <link rel="alternate" hreflang="{{ .Lang }}" href="{{ if eq .Lang "ru" }}{{ $.Site.BaseURL }}{{ else }}{{ $.Site.BaseURL }}{{ .Lang }}/{{ end }}">
    {{ end }}
    <link rel="alternate" hreflang="x-default" href="{{ .Site.BaseURL }}">

    <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
    <meta property="og:title" content="{{ if and .Title (not .IsHome) }}{{ .Title }} — {{ end }}{{ if or (eq .Site.Language.Lang "en") (hasPrefix .RelPermalink "/en/") }}Kirill Shvakov{{ else }}{{ .Site.Title }}{{ end }}">
    <meta property="og:description" content="{{ if .Params.description }}{{ .Params.description | plainify | truncate 160 }}{{ else if .Description }}{{ .Description | plainify | truncate 160 }}{{ else }}{{ .Site.Params.description }}{{ end }}">
    <meta property="og:url" content="{{ .Permalink }}">

    {{ block "head" . }}{{ end }}
</head>
<body>
    <div class="container">
        <header>
            <h1>
                <a href="{{ if eq .Language.Lang "ru" }}{{ .Site.BaseURL }}{{ else }}{{ .Site.BaseURL }}{{ .Language.Lang }}/{{ end }}" style="text-decoration: none; color: inherit;">
                    <span>{{ if or (eq .Site.Language.Lang "en") (hasPrefix .RelPermalink "/en/") }}Kirill Shvakov{{ else }}{{ .Site.Title }}{{ end }}</span>
                </a>
            </h1>
            <div class="header-controls">
                <button id="theme-toggle" class="theme-btn" aria-label="Toggle theme">
                    <span class="theme-icon">☀</span>
                </button>
                <div class="lang-switcher">
                    {{ range .Site.Languages }}
                    {{ $isActive := eq .Lang $.Language.Lang }}
                    <a class="lang-btn{{ if $isActive }} active{{ end }}" 
                       href="{{ if eq .Lang "ru" }}{{ $.Site.BaseURL }}{{ else }}{{ $.Site.BaseURL }}{{ .Lang }}/{{ end }}" 
                       lang="{{ .Lang }}" 
                       hreflang="{{ .Lang }}"
                       {{ if $isActive }}aria-current="page"{{ end }}>{{ .LanguageName }}</a>
                    {{ end }}
                </div>
            </div>
        </header>

        <main>
            {{ block "main" . }}{{ end }}
        </main>
    </div>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "{{ if or (eq .Site.Language.Lang "en") (hasPrefix .RelPermalink "/en/") }}Kirill Shvakov{{ else }}{{ .Site.Params.author }}{{ end }}",
      "jobTitle": "{{ .Site.Params.jobTitle }}",
      "worksFor": {
        "@type": "Organization",
        "name": "{{ .Site.Params.company }}",
        "url": "{{ .Site.Params.companyURL }}"
      },
      "url": "{{ .Site.BaseURL }}",
      "sameAs": [
        "{{ .Site.Params.github }}",
        "{{ .Site.Params.telegram }}"
      ]
    }
    </script>
    <script src="/assets/site.js"></script>
    {{ if .Site.Params.metrika_id }}
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
        (function(m,e,t,r,i,k,a){
            m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
            m[i].l=1*new Date();
            for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
            k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
        })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id={{ .Site.Params.metrika_id }}', 'ym');

        ym({{ .Site.Params.metrika_id }}, 'init', {ssr:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/{{ .Site.Params.metrika_id }}" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
    {{ end }}
</body>
</html>

